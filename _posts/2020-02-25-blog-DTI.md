---
title: 'Useful links for DTI processing'
date: 2019-09-05
permalink: /posts/2020/2/DTI/
categories:
  - Tools
  - Neuroscience
---

### From DICOM to NfiTi
DICOM is usually the data format downloaded form the scanner or the PACS system. (PACS system is an archiving system widely used in hospitals that data can be transdered from the scanner into the system via Network) However, for research purposes, NfiTi (.nii) format is used, so we need to tranform DICOM data to NfiTi. [More info see Li et al](https://rachel-sunrui.github.io/assets/Li_et_al_DICOM2NIfTI.pdf)


DICOM is saved as in a 2D protocol. A lot of important infomation is saved in the DICOM header in order to get the 3D (T1 anatonmy scan) or 4D (fMRI or DTI) NfiTi images. Below lists some important header tags that are important:
1. **The number of slices:**
A lot of cases, this tag could be tested by loading all of the files and then counting the slices for 3D images. For 4d sequences like DTI and fMRI, where you have a set of volumes acquired many times, you also need to look at the DICOM *SliceLocation* field, which tells you the slice's position in the volume (in physical space units). The number of unique slice locations is the 'official' DICOM indication of the number of slices. *The number of direction* is defined by the gradient file code. So, for grad file code 865, the number of directions is 30. This is the total number of non-collinear directions you used, not including the b0s. If Bob defined the protocol, the number of directions can be guessed from the protocol name stored in the header (info.SeriesDescription). MORE IMPORTANTLY -- we should never have to specify this, preprocessing script should derive this information from the grad file. *Copied from [Number of slices section](https://web.stanford.edu/group/vista/cgi-bin/wiki/index.php/DTI_Preprocessing_User_Manual)*

2. **qform and sform:**
*qform* is used to transfer the image from the voxel space (i,j,k) to scanner space (x,y,z). *sform* is an affine transform between coordinate systems. For more information on how these two values are used in the transformation, please check [nifti1.h header documentation](https://nifti.nimh.nih.gov/nifti-1/documentation/nifti1fields/nifti1fields_pages/qsform.html).

3. **b-value:**
  * This is a tag specifically for DTI data that reflects the strength and timing of the gradients used to generate diffusion-weighted images. 
  * It depends on the strength, duration, and spacing of these pulsed gradients. A larger b-value is achieved with increasing the gradient amplitude and duration and by widening the interval between gradient pulses.
  * The value of b is selected by the operator prior to imaging. Larger b shows progressively more diffusion weighting but also more noise. Mechanical vibration artifacts may also be a problem as b-values are increased.  
  * As a practical matter, most routine clinical DWI currently use b-values between 0 and 1000, with slightly lower values being used outside the central nervous system. 
  * *Copied from [mriquestions](http://mriquestions.com/what-is-the-b-value.html)*



<!-- The caregories I used:
  - Tools
  - Coding
  - Neuroscience
  - Machine learning
  - Image processing
  - Signal processing -->